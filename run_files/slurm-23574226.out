/var/spool/slurm/d/job23574226/slurm_script: line 10: conda: command not found
[03/07/2022 12:15:12 INFO] Running command TRAIN
[03/07/2022 12:15:12 WARNING] From experiment.py:58: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

[03/07/2022 12:15:12 INFO] Number of GPUs detected: 4
[03/07/2022 12:15:14 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/datasets/synthetic_shapes.py:129: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

[03/07/2022 12:15:14 INFO] Extracting archive for primitive draw_lines.
[03/07/2022 12:15:18 INFO] Extracting archive for primitive draw_polygon.
[03/07/2022 12:15:23 INFO] Extracting archive for primitive draw_multiple_polygons.
[03/07/2022 12:15:28 INFO] Extracting archive for primitive draw_ellipses.
[03/07/2022 12:15:33 INFO] Extracting archive for primitive draw_star.
[03/07/2022 12:15:38 INFO] Extracting archive for primitive draw_checkerboard.
[03/07/2022 12:15:43 INFO] Extracting archive for primitive draw_stripes.
[03/07/2022 12:15:47 INFO] Extracting archive for primitive draw_cube.
[03/07/2022 12:15:52 INFO] Extracting archive for primitive gaussian_noise.
[03/07/2022 12:15:58 WARNING] Entity <function SyntheticShapes._get_data.<locals>.<lambda> at 0x2aede8630400> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Failed to parse source code of <function SyntheticShapes._get_data.<locals>.<lambda> at 0x2aede8630400>, which Python reported as:
                    lambda image, points:

If this is a lambda function, the error may be avoided by creating the lambda in a standalone statement.
[03/07/2022 12:15:58 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/datasets/synthetic_shapes.py:167: The name tf.read_file is deprecated. Please use tf.io.read_file instead.

[03/07/2022 12:15:58 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/datasets/synthetic_shapes.py:189: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
    
[03/07/2022 12:15:59 INFO] Caching data, fist access will take some time.
[03/07/2022 12:15:59 WARNING] From /home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.random_shuffle is deprecated. Please use tf.random.shuffle instead.

[03/07/2022 12:15:59 WARNING] From /home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.random_uniform is deprecated. Please use tf.random.uniform instead.

[03/07/2022 12:15:59 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/datasets/utils/photometric_augmentation.py:26: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
[03/07/2022 12:15:59 WARNING] From /home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

2022-03-07 12:16:00.530745: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2022-03-07 12:16:02.361102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2022-03-07 12:16:02.362416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 1 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2022-03-07 12:16:02.363725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 2 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
2022-03-07 12:16:02.365041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 3 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2022-03-07 12:16:02.373145: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-03-07 12:16:02.403459: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2022-03-07 12:16:02.436848: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2022-03-07 12:16:02.497805: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2022-03-07 12:16:02.540303: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2022-03-07 12:16:02.565304: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2022-03-07 12:16:02.632277: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2022-03-07 12:16:02.644322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3
[03/07/2022 12:16:03 WARNING] 
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

[03/07/2022 12:16:03 WARNING] From /home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.truncated_normal is deprecated. Please use tf.random.truncated_normal instead.

[03/07/2022 12:16:03 WARNING] From /home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.lin_space is deprecated. Please use tf.linspace instead.

[03/07/2022 12:16:03 WARNING] From /home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.matrix_solve_ls is deprecated. Please use tf.linalg.lstsq instead.

[03/07/2022 12:16:05 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/homographies.py:218: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
[03/07/2022 12:16:05 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/homographies.py:277: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
[03/07/2022 12:16:05 WARNING] From /home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/autograph/converters/directives.py:119: The name tf.matrix_inverse is deprecated. Please use tf.linalg.inv instead.

[03/07/2022 12:16:06 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/datasets/base_dataset.py:109: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)`.
[03/07/2022 12:16:06 WARNING] Entity <function SyntheticShapes._get_data.<locals>.<lambda> at 0x2aedfa127950> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Failed to parse source code of <function SyntheticShapes._get_data.<locals>.<lambda> at 0x2aedfa127950>, which Python reported as:
                    lambda image, points:

If this is a lambda function, the error may be avoided by creating the lambda in a standalone statement.
[03/07/2022 12:16:06 INFO] Caching data, fist access will take some time.
[03/07/2022 12:16:06 WARNING] Entity <function SyntheticShapes._get_data.<locals>.<lambda> at 0x2aedfa4c4510> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: Failed to parse source code of <function SyntheticShapes._get_data.<locals>.<lambda> at 0x2aedfa4c4510>, which Python reported as:
                    lambda image, points:

If this is a lambda function, the error may be avoided by creating the lambda in a standalone statement.
[03/07/2022 12:16:06 INFO] Caching data, fist access will take some time.
[03/07/2022 12:16:06 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/datasets/base_dataset.py:111: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2022-03-07 12:16:06.971140: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2022-03-07 12:16:06.978034: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2399860000 Hz
2022-03-07 12:16:06.978537: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x89d0320 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-03-07 12:16:06.978556: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-03-07 12:16:07.307709: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x599f6c0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2022-03-07 12:16:07.307739: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-12GB, Compute Capability 6.0
2022-03-07 12:16:07.307760: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): Tesla P100-PCIE-12GB, Compute Capability 6.0
2022-03-07 12:16:07.307764: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (2): Tesla P100-PCIE-12GB, Compute Capability 6.0
2022-03-07 12:16:07.307769: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (3): Tesla P100-PCIE-12GB, Compute Capability 6.0
2022-03-07 12:16:07.311009: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2022-03-07 12:16:07.311808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 1 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2022-03-07 12:16:07.312624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 2 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
2022-03-07 12:16:07.313453: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 3 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2022-03-07 12:16:07.313493: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-03-07 12:16:07.313507: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2022-03-07 12:16:07.313517: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2022-03-07 12:16:07.313527: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2022-03-07 12:16:07.313536: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2022-03-07 12:16:07.313556: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2022-03-07 12:16:07.313572: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2022-03-07 12:16:07.319559: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3
2022-03-07 12:16:07.319589: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-03-07 12:16:07.322960: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-03-07 12:16:07.322976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 1 2 3 
2022-03-07 12:16:07.322999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N Y N N 
2022-03-07 12:16:07.323004: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 1:   Y N N N 
2022-03-07 12:16:07.323008: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 2:   N N N Y 
2022-03-07 12:16:07.323013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 3:   N N Y N 
2022-03-07 12:16:07.326903: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11346 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-03-07 12:16:07.328136: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11346 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2022-03-07 12:16:07.329378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 11346 MB memory) -> physical GPU (device: 2, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2022-03-07 12:16:07.330617: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 11346 MB memory) -> physical GPU (device: 3, name: Tesla P100-PCIE-12GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:105: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:121: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:121: The name tf.AUTO_REUSE is deprecated. Please use tf.compat.v1.AUTO_REUSE instead.

[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:232: DatasetV1.output_shapes (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.data.get_output_shapes(dataset)`.
[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:242: DatasetV1.output_types (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.compat.v1.data.get_output_types(dataset)`.
[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:241: DatasetV1.make_initializable_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `for ... in dataset:` to iterate over a dataset. If using `tf.estimator`, return the `Dataset` object directly from your input function. As a last resort, you can use `tf.compat.v1.data.make_initializable_iterator(dataset)`.
[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:257: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:258: The name tf.data.Iterator is deprecated. Please use tf.compat.v1.data.Iterator instead.

[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:153: The name tf.train.replica_device_setter is deprecated. Please use tf.compat.v1.train.replica_device_setter instead.

[03/07/2022 12:16:07 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/backbones/vgg.py:10: conv2d (from tensorflow.python.layers.convolutional) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.keras.layers.Conv2D` instead.
[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/layers/convolutional.py:424: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/backbones/vgg.py:14: batch_normalization (from tensorflow.python.layers.normalization) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.BatchNormalization instead.  In particular, `tf.control_dependencies(tf.GraphKeys.UPDATE_OPS)` should not be used (consult the `tf.keras.layers.batch_normalization` documentation).
[03/07/2022 12:16:07 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:07 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/backbones/vgg.py:28: max_pooling2d (from tensorflow.python.layers.pooling) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.MaxPooling2D instead.
[03/07/2022 12:16:07 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:07 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:07 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:07 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:07 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:07 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:07 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:07 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/utils.py:24: The name tf.depth_to_space is deprecated. Please use tf.compat.v1.depth_to_space instead.

[03/07/2022 12:16:08 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/utils.py:57: The name tf.space_to_depth is deprecated. Please use tf.compat.v1.space_to_depth instead.

[03/07/2022 12:16:08 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/utils.py:70: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

[03/07/2022 12:16:08 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:161: The name tf.get_collection is deprecated. Please use tf.compat.v1.get_collection instead.

[03/07/2022 12:16:08 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:161: The name tf.GraphKeys is deprecated. Please use tf.compat.v1.GraphKeys instead.

[03/07/2022 12:16:08 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:163: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:08 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:09 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:206: The name tf.summary.scalar is deprecated. Please use tf.compat.v1.summary.scalar instead.

[03/07/2022 12:16:10 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:210: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:10 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:266: The name tf.summary.merge_all is deprecated. Please use tf.compat.v1.summary.merge_all instead.

[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:11 INFO] Scale of 0 disables regularizer.
[03/07/2022 12:16:12 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:276: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

2022-03-07 12:16:12.133743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:03:00.0
2022-03-07 12:16:12.134571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 1 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:04:00.0
2022-03-07 12:16:12.135384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 2 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:82:00.0
2022-03-07 12:16:12.136301: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 3 with properties: 
name: Tesla P100-PCIE-12GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:83:00.0
2022-03-07 12:16:12.136358: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2022-03-07 12:16:12.136371: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2022-03-07 12:16:12.136402: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2022-03-07 12:16:12.136429: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2022-03-07 12:16:12.136440: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2022-03-07 12:16:12.136453: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2022-03-07 12:16:12.136465: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2022-03-07 12:16:12.142782: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3
2022-03-07 12:16:12.142841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-03-07 12:16:12.142849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 1 2 3 
2022-03-07 12:16:12.142855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N Y N N 
2022-03-07 12:16:12.142860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 1:   Y N N N 
2022-03-07 12:16:12.142865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 2:   N N N Y 
2022-03-07 12:16:12.142869: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 3:   N N Y N 
2022-03-07 12:16:12.146823: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 11346 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-12GB, pci bus id: 0000:03:00.0, compute capability: 6.0)
2022-03-07 12:16:12.147633: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 11346 MB memory) -> physical GPU (device: 1, name: Tesla P100-PCIE-12GB, pci bus id: 0000:04:00.0, compute capability: 6.0)
2022-03-07 12:16:12.148441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 11346 MB memory) -> physical GPU (device: 2, name: Tesla P100-PCIE-12GB, pci bus id: 0000:82:00.0, compute capability: 6.0)
2022-03-07 12:16:12.149292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 11346 MB memory) -> physical GPU (device: 3, name: Tesla P100-PCIE-12GB, pci bus id: 0000:83:00.0, compute capability: 6.0)
[03/07/2022 12:16:15 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:287: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

[03/07/2022 12:16:15 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:288: The name tf.local_variables_initializer is deprecated. Please use tf.compat.v1.local_variables_initializer instead.

[03/07/2022 12:16:16 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:295: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

[03/07/2022 12:16:16 WARNING] From /home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py:298: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

[03/07/2022 12:16:16 INFO] Start training
2022-03-07 12:16:22.313406: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2022-03-07 12:16:23.282098: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Not found: ./bin/ptxas not found
Relying on driver to perform ptx compilation. This message will be only logged once.
2022-03-07 12:16:23.376308: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
Traceback (most recent call last):
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1365, in _do_call
    return fn(*args)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1350, in _run_fn
    target_list, run_metadata)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1443, in _call_tf_sessionrun
    run_metadata)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Input shape axis 0 must equal 200, got shape [100,120,160]
	 [[{{node magicpoint/eval_data_sharding/unstack_2}}]]
	 [[magicpoint/eval_tower0/map/while/box_nms/non_max_suppression/NonMaxSuppressionV3/_1641]]
  (1) Invalid argument: Input shape axis 0 must equal 200, got shape [100,120,160]
	 [[{{node magicpoint/eval_data_sharding/unstack_2}}]]
0 successful operations.
3 derived errors ignored.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "experiment.py", line 161, in <module>
    args.func(config, output_dir, args)
  File "experiment.py", line 98, in _cli_train
    train(config, config['train_iter'], output_dir, pretrained_dir)
  File "experiment.py", line 31, in train
    keep_checkpoints=config.get('keep_checkpoints', 1))
  File "/home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py", line 318, in train
    metrics = self.evaluate('validation', mute=True)
  File "/home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py", line 371, in evaluate
    feed_dict={self.handle: self.dataset_handles[dataset]}))
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 956, in run
    run_metadata_ptr)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1359, in _do_run
    run_metadata)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1384, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Input shape axis 0 must equal 200, got shape [100,120,160]
	 [[node magicpoint/eval_data_sharding/unstack_2 (defined at /home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[magicpoint/eval_tower0/map/while/box_nms/non_max_suppression/NonMaxSuppressionV3/_1641]]
  (1) Invalid argument: Input shape axis 0 must equal 200, got shape [100,120,160]
	 [[node magicpoint/eval_data_sharding/unstack_2 (defined at /home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py:1748) ]]
0 successful operations.
3 derived errors ignored.

Original stack trace for 'magicpoint/eval_data_sharding/unstack_2':
  File "experiment.py", line 161, in <module>
    args.func(config, output_dir, args)
  File "experiment.py", line 98, in _cli_train
    train(config, config['train_iter'], output_dir, pretrained_dir)
  File "experiment.py", line 22, in train
    with _init_graph(config) as net:
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/contextlib.py", line 82, in __enter__
    return next(self.gen)
  File "experiment.py", line 75, in _init_graph
    n_gpus=n_gpus, **config['model'])
  File "/home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py", line 122, in __init__
    self._build_graph()
  File "/home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py", line 265, in _build_graph
    self._eval_graph(data)
  File "/home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py", line 216, in _eval_graph
    tower_metrics = self._gpu_tower(data, Mode.EVAL, self.config['eval_batch_size'])
  File "/home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py", line 142, in _gpu_tower
    shards = self._unstack_nested_dict(data, batch_size*self.n_gpus)
  File "/home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py", line 126, in _unstack_nested_dict
    else tf.unstack(v, num=num, axis=0) for k, v in d.items()}
  File "/home/thamilchelvan.a/NUFRL/SuperPoint/superpoint/models/base_model.py", line 126, in <dictcomp>
    else tf.unstack(v, num=num, axis=0) for k, v in d.items()}
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/ops/array_ops.py", line 1323, in unstack
    return gen_array_ops.unpack(value, num=num, axis=axis, name=name)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/ops/gen_array_ops.py", line 12000, in unpack
    "Unpack", value=value, num=num, axis=axis, name=name)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/framework/op_def_library.py", line 794, in _apply_op_helper
    op_def=op_def)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 3357, in create_op
    attrs, op_def, compute_device)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 3426, in _create_op_internal
    op_def=op_def)
  File "/home/thamilchelvan.a/.conda/envs/SuperPoint/lib/python3.6/site-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

terminate called without an active exception
/var/spool/slurm/d/job23574226/slurm_script: line 16: 18980 Aborted                 python experiment.py train configs/magic-point-ir_shapes.yaml magic-point-ir_shapes_p100
